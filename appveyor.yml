environment:
  access_token:
    secure: YEOldcmUtP23lCJLGxBYZu8TCFlb9DX+IWGK761pexF2fhy9VrDdt3cmWW1jLTt/
image:
  - Ubuntu1804

branches:
  only:
    - master

build:
  verbosity: detailed

install:
  - echo "Install LLVM 10"
  - wget -O - https://apt.llvm.org/llvm-snapshot.gpg.key | sudo apt-key add -
  - sudo add-apt-repository "deb http://apt.llvm.org/bionic/ llvm-toolchain-bionic-10 main"
  - sudo apt-get update
  - sudo apt-get install -y clang-9 lldb-9 lld-9 clangd-9 llvm-9 llvm-9-dev clang-tools-9
  - sudo apt-get install -y clang-10 lldb-10 lld-10 clangd-10 llvm-10 llvm-10-dev clang-tools-10
  - echo "Install submodules"
  - git submodule update --init --recursive


build_script:
  - cmake -S . -B build -DCMAKE_TOOLCHAIN_FILE=clang-toolchain.cmake -DCMAKE_BUILD_TYPE=Debug
  - cd build
  - cmake --build .

test_script:
  - cd test
  - ctest

on_success:
  - echo "Done"
  - pwd
  - cd ..
  - make llvm_cover_report_all


